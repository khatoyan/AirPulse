# AirPulse Backend

Бэкенд для приложения мониторинга качества воздуха и аллергических рисков.

## Установка и запуск

1. Клонируйте репозиторий
2. Установите зависимости:
   ```bash
   npm install
   ```
3. Настройте переменные окружения (скопируйте .env.example в .env и отредактируйте)
4. Запустите миграции базы данных:
   ```bash
   npm run prisma:migrate
   ```
5. Сгенерируйте клиент Prisma:
   ```bash
   npm run prisma:generate
   ```
6. Запустите сервер:
   - Для разработки: `npm run dev`
   - Для продакшена: `npm run build` и затем `npm start`

## API Endpoints

### Аутентификация

- **POST /api/auth/register** - Регистрация нового пользователя
- **POST /api/auth/login** - Вход в систему
- **GET /api/auth/me** - Получение информации о текущем пользователе (требуется JWT токен)

### Отчеты о загрязнении

- **GET /api/reports** - Получить все одобренные отчеты
- **POST /api/reports** - Создать новый отчет (требуется JWT токен)
- **GET /api/reports/zone** - Получить отчеты в указанной зоне по координатам
- **GET /api/reports/pending** - Получить отчеты, ожидающие модерации (только для админов)
- **PUT /api/reports/:id/approve** - Одобрить отчет (только для админов)
- **PUT /api/reports/:id/reject** - Отклонить отчет (только для админов)
- **GET /api/reports/stats** - Получить статистику по отчетам (только для админов)

### Зоны

- **GET /api/zones** - Получить все зоны
- **POST /api/zones** - Создать новую зону
- **PATCH /api/zones/:id/index** - Обновить индекс опасности зоны

### Растения

- **GET /api/plants** - Получить все растения
- **GET /api/plants/:id** - Получить растение по ID
- **POST /api/plants** - Добавить новое растение (только для админов)
- **PUT /api/plants/:id** - Обновить информацию о растении (только для админов)
- **DELETE /api/plants/:id** - Удалить растение (только для админов)

### Погода

- **GET /api/weather/current** - Получить текущие погодные данные по координатам
- **GET /api/weather/latest** - Получить последние сохраненные погодные данные

## Структура базы данных

База данных состоит из следующих основных моделей:
- User - пользователи и их аллергические данные
- Report - отчеты о симптомах и растениях
- Plant - информация о растениях-аллергенах
- Zone - зоны с индексами риска
- WeatherData - данные о погоде 